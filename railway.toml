[build]
  builder = "NIXPACKS"

[[nixpacks.providers]]
  nixPkgs = ['python3', 'python3-pip']

[nixpacks.phases.setup]
  nixPkgs = ['python3', 'python3-pip']

[nixpacks.phases.build]
  cmds = [
    'pip install -r 111/requirements.txt',
    'cd 111/school && python manage.py collectstatic --noinput || true'
  ]

[nixpacks.phases.run]
  cmds = [
    'bash start.sh'
  ]

# Explicitly configure as a web service
[deploy]
  startCommand = "bash start.sh"
  healthcheckPath = "/health"
  healthcheckTimeout = 100
  restartPolicyType = "ON_FAILURE"
  restartPolicyMaxRetries = 10
