{% load static %}
<!DOCTYPE html>
<html lang="fr" data-theme="light">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>{% block title %}GénieSystemeSchool{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet"/>
  <style type="text/tailwindcss">
    /* Theme variables (light defaults) */
    :root {
      --app-green: #16a34a;
      --app-green-2: #059669;
      --bg-primary: #f7fafc; /* page background */
      --bg-card: #ffffff; /* cards / modals */
      --bg-sidebar: linear-gradient(180deg,#ffffff,#f8fafc);
      --sidebar-border: rgba(2,6,23,0.04);
      --text-primary: #0f172a;
      --text-secondary: #334155;
      --hover-bg: rgba(2,6,23,0.03);
      --active-link-bg: rgba(22,163,74,0.06);
      --active-link-text: #06202a;
      --shadow-color: rgba(2,6,23,0.06);
      --modal-overlay: rgba(2,6,23,0.45);
  --accent-1: #06b6d4;
  --accent-2: #16a34a; /* unified app green (same as inscriptions.html) */
      --transition-fast: .18s;
    }
    /* Dark theme overrides (darker / Discord-like) */
    [data-theme="dark"] {
      --bg-primary: #0b0d10; /* very dark background like Discord */
      --bg-card: #111217; /* darker card surface */
      --bg-sidebar: linear-gradient(180deg,#0d0f13,#07080a);
      --sidebar-border: rgba(255,255,255,0.02);
      --text-primary: #DCDDDE; /* near-white text similar to Discord */
      --text-secondary: #99A0AA; /* muted secondary */
      --hover-bg: rgba(255,255,255,0.02);
      --active-link-bg: rgba(88,101,242,0.06); /* subtle blurple */
      --active-link-text: #DCDDDE;
      --shadow-color: rgba(0,0,0,0.7);
      --modal-overlay: rgba(0,0,0,0.78);
      --accent-1: #5865f2; /* Discord-like blurple */
      --accent-2: #4752c4;
    }

    /* Base layout colors using variables */
    body { font-family: 'Poppins', sans-serif; background-color: var(--bg-primary); color: var(--text-primary); }
    .main-content { background-color: var(--bg-primary); transition: background-color var(--transition-fast) ease, color var(--transition-fast) ease; }
    .card, .modal, .popup, .dropdown { background: var(--bg-card); color: var(--text-primary); border-radius: 0.75rem; box-shadow: 0 8px 20px var(--shadow-color); transition: background var(--transition-fast) ease, color var(--transition-fast) ease, box-shadow .22s ease; }
    .btn-primary { background-color: var(--accent-2); color: white; }
    .btn-secondary { background-color: rgba(255,255,255,0.04); color: var(--text-primary); }
  .btn-danger { background: linear-gradient(90deg,#ff7a7a,#ef4444); color: #fff; border: none; }
  .btn-danger:hover { transform: translateY(-2px); }
  /* Global icon button used for small action icons (edit/delete) */
  .icon-btn { background: var(--icon-btn-bg, #ffffff); border: 0; padding:8px; cursor:pointer; border-radius:10px; display:inline-flex; align-items:center; justify-content:center; box-shadow: 0 6px 18px rgba(2,6,23,0.06); transition: transform .14s ease, box-shadow .14s ease; min-width:40px; height:40px; }
  .icon-btn:hover { transform: translateY(-3px); }
  /* Filled green icon button to match primary look */
  .icon-btn.edit { background: var(--accent-2); color: #ffffff; border: none; box-shadow: 0 8px 26px rgba(16,185,129,0.12); }
  .icon-btn.edit:hover { background: #15803d; transform: translateY(-3px); }
  /* Delete icon button: unified style matching students page (stronger red hover and icon treatment)
     Support several naming conventions used across templates: .icon-btn.delete, .delete-btn.icon-btn,
     and other variants like .delete-ens-btn.icon-btn or .delete-form-btn.icon-btn */
  .icon-btn.delete,
  .delete-btn.icon-btn,
  .icon-btn[class*="delete"],
  [class*="delete-"].icon-btn {
    transition: transform .16s cubic-bezier(.2,.9,.25,1), box-shadow .16s ease, background .18s ease;
    background-image: linear-gradient(90deg, rgba(239,68,68,0.05), rgba(239,68,68,0.02));
    border: 1px solid rgba(0,0,0,0.04);
    color: #ef4444;
    box-shadow: 0 6px 18px rgba(2,6,23,0.06);
  }
  .icon-btn.delete:hover,
  .delete-btn.icon-btn:hover,
  .icon-btn[class*="delete"]:hover,
  [class*="delete-"].icon-btn:hover {
    transform: translateY(-6px) scale(1.08);
    box-shadow: 0 18px 40px rgba(239,68,68,0.14);
    background: linear-gradient(90deg,#f97316,#ef4444);
    color: #ffffff;
  }
  /* Default icon colors for delete buttons */
  .icon-btn.delete .icon-svg path,
  .icon-btn.delete .icon-svg rect,
  .delete-btn.icon-btn .icon-svg path,
  .delete-btn.icon-btn .icon-svg rect,
  .icon-btn[class*="delete"] .icon-svg path,
  .icon-btn[class*="delete"] .icon-svg rect,
  [class*="delete-"].icon-btn .icon-svg path,
  [class*="delete-"].icon-btn .icon-svg rect {
    stroke: #dc2626 !important; /* strong red */
    fill: #fff5f5 !important;   /* soft white fill to match etudiants.html */
    stroke-width: 1.4px;
  }
  /* Hovered icon becomes light/white for contrast */
  .icon-btn.delete:hover .icon-svg path,
  .icon-btn.delete:hover .icon-svg rect,
  .delete-btn.icon-btn:hover .icon-svg path,
  .delete-btn.icon-btn:hover .icon-svg rect,
  .icon-btn[class*="delete"]:hover .icon-svg path,
  .icon-btn[class*="delete"]:hover .icon-svg rect,
  [class*="delete-"].icon-btn:hover .icon-svg path,
  [class*="delete-"].icon-btn:hover .icon-svg rect {
    stroke: #fff5f5 !important;
    fill: #fff5f5 !important;
    opacity: 1 !important;
  }
  .icon-btn .icon-svg { width:18px; height:18px; display:block; }
  /* Also support inline SVGs and Material Icons inside delete buttons that don't have the .icon-svg wrapper */
  .icon-btn.delete svg, .delete-btn.icon-btn svg, .icon-btn[class*="delete"] svg, [class*="delete-"].icon-btn svg,
  .icon-btn.delete .material-icons, .delete-btn.icon-btn .material-icons {
  width:18px; height:18px; display:block; color: #ef4444; /* fallback color */
  }
  .icon-btn.delete:hover svg path, .delete-btn.icon-btn:hover svg path, .icon-btn.delete:hover svg rect, .delete-btn.icon-btn:hover svg rect,
  .icon-btn.delete:hover .material-icons, .delete-btn.icon-btn:hover .material-icons {
    color: #fff !important; fill: #fff !important; stroke: #fff !important;
  }

    /* Sidebar/nav styles */
    .sidebar { background: var(--bg-sidebar); border-right: none; box-shadow: 8px 0 24px rgba(2,6,23,0.06); transition: width .25s ease, transform .25s, background .22s ease; position:relative; }
    .sidebar .logo-text h1 { letter-spacing: .2px; color: var(--text-primary); }
    a, a:link, a:visited { text-decoration: none !important; border-bottom: none !important; box-shadow: none !important; }
  .sidebar a { transition: transform calc(var(--transition-fast) * 1.1) cubic-bezier(.2,.9,.25,1), background .22s ease, color .18s ease; font-size:1.07rem; padding: .7rem 1rem; display:flex; align-items:center; gap:.75rem; border-radius:.75rem; color: var(--text-secondary); }
  /* larger icons for better visibility */
  .sidebar .material-icons { font-size:1.9rem; margin-right:.72rem; transition: transform .18s ease, color .18s ease; color: inherit; display:inline-block; line-height:1; }
  /* professional hover: subtle move, use app green for accents */
  .sidebar a:hover { transform: translateX(6px) scale(1.03); background: var(--active-link-bg); color: var(--text-primary); }
  .sidebar a:hover .material-icons { transform: translateX(3px) scale(1.10); color: var(--app-green); }

  /* make group-header inner links align like normal nav items */
  .group-header a { display:flex; align-items:center; justify-content:space-between; gap:.75rem; color: inherit; width:100%; padding: .55rem .9rem; }
  .group-header .material-icons { margin-right:.6rem; }
    .sidebar .group-header:hover { transform: translateX(4px); }
    .active-link { background: var(--active-link-bg); box-shadow: none; color: var(--active-link-text); border-left: none; font-weight: 600; }
    .nav-indicator { position: absolute; left: 6px; width:6px; height:44px; background: linear-gradient(180deg,var(--accent-1),var(--accent-2)); border-radius:6px; transition: top var(--transition-fast) cubic-bezier(.2,.9,.2,1), height .18s, opacity var(--transition-fast); opacity:0; z-index:40; }
    .nav-separator { width:4px; min-width:4px; display:flex; align-items:center; justify-content:center; background: transparent; }
    .nav-separator::before, .nav-separator::after { display: none !important; }

    /* submenu */
    .submenu { display: none; margin-left: 0; padding-left: 0; opacity:0; transform:translateY(-6px); }
    .submenu.open { display: block; opacity:1; transform:translateY(0); animation: submenuFadeIn .18s ease both; }
    @keyframes submenuFadeIn { from { opacity: 0; transform: translateY(-6px); } to { opacity: 1; transform: translateY(0); } }
    .sidebar .submenu li a { display:flex; align-items:center; padding:8px 14px; border-radius:8px; color: var(--text-secondary); font-size:0.95rem; }
    .sidebar .submenu li a:hover { background: var(--hover-bg); color: var(--text-primary); }
    .sidebar .submenu li a { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    /* user and toggle */
    .theme-toggle { display:inline-block; margin-left:8px; }
    .theme-toggle input { display:none; }
    .toggle-slider { width:44px; height:24px; background: rgba(0,0,0,0.06); border-radius:999px; display:inline-block; position:relative; vertical-align:middle; transition: background .18s; }
    .toggle-slider::after { content: ''; width:18px; height:18px; background: white; border-radius:50%; position:absolute; left:3px; top:3px; transition: transform .18s ease; }
    [data-theme="dark"] .toggle-slider { background: linear-gradient(90deg,var(--accent-2),var(--accent-1)); }
    [data-theme="dark"] .toggle-slider::after { transform: translateX(20px); }

    /* modal / popup overlay helper */
    .modal-overlay { position: fixed; inset: 0; background: var(--modal-overlay); display:flex; align-items:center; justify-content:center; z-index:60; }
    .modal { max-width: 720px; padding: 20px; }

    /* small utilities */
    .pill-badge { background: linear-gradient(90deg,var(--accent-2),var(--accent-1)); color: white; padding:2px 8px; border-radius:999px; font-size:0.75rem; }
    /* Dark-mode force: make cards, widgets, tables, filters and inputs clearly visible */
    [data-theme="dark"] .card,
    [data-theme="dark"] .panel,
    [data-theme="dark"] .widget,
    [data-theme="dark"] .info-card,
    [data-theme="dark"] .white-card,
    [data-theme="dark"] .revenue-card,
    [data-theme="dark"] .dropdown,
    [data-theme="dark"] .modal,
    [data-theme="dark"] .popup,
    [data-theme="dark"] .table,
    [data-theme="dark"] .table thead,
    [data-theme="dark"] .table tbody,
    [data-theme="dark"] .filters,
    [data-theme="dark"] .search-bar,
    [data-theme="dark"] .filter-chip {
      background: rgba(255,255,255,0.02) !important;
      color: var(--text-primary) !important;
      border: 1px solid rgba(255,255,255,0.04) !important;
      box-shadow: 0 8px 24px rgba(0,0,0,0.5) !important;
    }
    /* Tables and rows */
    [data-theme="dark"] table, [data-theme="dark"] .table { background: transparent !important; color: var(--text-primary) !important; }
    [data-theme="dark"] .table thead th { color: var(--text-secondary) !important; background: transparent !important; border-bottom: 1px solid rgba(255,255,255,0.04); }
    [data-theme="dark"] .table tbody tr td { color: var(--text-primary) !important; border-bottom: 1px solid rgba(255,255,255,0.02); }
    /* Inputs / selects / search */
    [data-theme="dark"] input, [data-theme="dark"] textarea, [data-theme="dark"] select, [data-theme="dark"] .search-input {
      background: rgba(255,255,255,0.02) !important;
      color: var(--text-primary) !important;
      border: 1px solid rgba(255,255,255,0.04) !important;
      box-shadow: none !important;
    }
    /* Buttons in dark mode */
    [data-theme="dark"] .btn-secondary { background: transparent !important; color: var(--text-primary) !important; border: 1px solid rgba(255,255,255,0.04) !important; }
    [data-theme="dark"] .btn-primary { box-shadow: 0 6px 18px rgba(124,58,237,0.12); }
    /* Ensure titles, headings and small text are readable */
    [data-theme="dark"] h1, [data-theme="dark"] h2, [data-theme="dark"] h3, [data-theme="dark"] h4, [data-theme="dark"] h5, [data-theme="dark"] p, [data-theme="dark"] span, [data-theme="dark"] a {
      color: var(--text-primary) !important;
    }
    /* Special: make any explicit white backgrounds darker (fallback) */
    [data-theme="dark"] [style*="background: #fff"], [data-theme="dark"] [style*="background: white"] {
      background: rgba(255,255,255,0.02) !important;
      color: var(--text-primary) !important;
    }
    /* Force common Tailwind white/gray and light color utilities to dark-friendly backgrounds */
    [data-theme="dark"] .bg-white,
    [data-theme="dark"] .bg-gray-50,
    [data-theme="dark"] .bg-gray-100,
    [data-theme="dark"] .bg-gray-200,
    [data-theme="dark"] .bg-gray-100\/50,
    [data-theme="dark"] .bg-white\/50,
    [data-theme="dark"] .bg-blue-50,
    [data-theme="dark"] .bg-pink-50,
    [data-theme="dark"] .bg-green-50,
    [data-theme="dark"] .bg-yellow-50,
    [data-theme="dark"] .bg-purple-100 {
      background: rgba(255,255,255,0.02) !important;
      color: var(--text-primary) !important;
      border: 1px solid rgba(255,255,255,0.04) !important;
      box-shadow: 0 8px 24px rgba(0,0,0,0.45) !important;
    }
    /* Override colored text utilities that are dark on light themes */
    [data-theme="dark"] .text-blue-700,
    [data-theme="dark"] .text-pink-600,
    [data-theme="dark"] .text-green-700,
    [data-theme="dark"] .text-amber-600,
    [data-theme="dark"] .text-purple-600,
    [data-theme="dark"] .text-black,
    [data-theme="dark"] .text-gray-900,
    [data-theme="dark"] .text-gray-800 {
      color: var(--text-primary) !important;
    }
    /* Map small utility text colors used across templates to readable dark-mode values */
    [data-theme="dark"] .text-gray-500, [data-theme="dark"] .text-gray-600, [data-theme="dark"] .text-gray-400 {
      color: var(--text-secondary) !important;
    }
    [data-theme="dark"] .text-red-600, [data-theme="dark"] .text-red-500 {
      color: #f87171 !important; /* visible red */
    }
    [data-theme="dark"] .text-green-700, [data-theme="dark"] .text-green-600 {
      color: #34d399 !important; /* visible green */
    }
    [data-theme="dark"] .text-amber-600, [data-theme="dark"] .text-amber-500 {
      color: #f59e0b !important; /* visible amber */
    }
    /* Neutralize common inline light-color usages in templates (labels, small text) */
    [data-theme="dark"] [style*="color:#6b7280"],
    [data-theme="dark"] [style*="color: #6b7280"] {
      color: var(--text-secondary) !important;
    }
    /* Make inline balance labels (amber) visible in dark mode */
    [data-theme="dark"] [style*="color:#92400e"],
    [data-theme="dark"] [style*="color: #92400e"] {
      color: #fb923c !important;
      font-weight:700 !important;
    }
    /* Convert small inline light-yellow banners to visible amber gradient in dark mode */
    [data-theme="dark"] [style*="background:#fff7ed"],
    [data-theme="dark"] [style*="background: #fff7ed"] {
      background: linear-gradient(90deg,#92400e,#fb923c) !important;
      color: #ffffff !important;
      border: none !important;
      box-shadow: 0 6px 18px rgba(146,64,14,0.12) !important;
    }
    /* Make the inscription remaining amount visible (use amber by default) */
    [data-theme="dark"] .inscription-remaining, [data-theme="dark"] .remaining-amount {
      color: #fb923c !important;
      font-weight:700 !important;
    }
    /* Ensure amounts are readable */
    [data-theme="dark"] .amount { color: var(--text-primary) !important; }
    /* Specific dashboard small tiles (apprenants) */
    [data-theme="dark"] .card .bg-blue-50,
    [data-theme="dark"] .card .bg-pink-50,
    [data-theme="dark"] .card .bg-green-50,
    [data-theme="dark"] .card .bg-yellow-50 {
      background: rgba(255,255,255,0.02) !important;
      color: var(--text-primary) !important;
    }
    [data-theme="dark"] .card .material-icons { color: var(--text-secondary) !important; filter: brightness(1.2); }
    [data-theme="dark"] .card .text-blue-700,
    [data-theme="dark"] .card .text-pink-600,
    [data-theme="dark"] .card .text-green-700,
    [data-theme="dark"] .card .text-amber-600 {
      color: var(--text-primary) !important;
    }
    /* Level bars and counts */
    [data-theme="dark"] .lvl-bar { background: rgba(255,255,255,0.03) !important; }
    [data-theme="dark"] .lvl-fill { box-shadow: none !important; }
    [data-theme="dark"] .level-name { color: var(--text-primary) !important; }
    [data-theme="dark"] .level-count { color: var(--text-secondary) !important; }
    /* Revenus card adjustments */
    [data-theme="dark"] .rev-card { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)) !important; }
    [data-theme="dark"] .rev-name { color: var(--text-primary) !important; }
    [data-theme="dark"] .rev-right, [data-theme="dark"] .rev-currency { color: var(--text-secondary) !important; }
    [data-theme="dark"] .rev-value { background: linear-gradient(90deg,var(--accent-1),var(--accent-2)) !important; }
    /* Recent avatars and list */
    [data-theme="dark"] .recent-avatar { background: rgba(255,255,255,0.03) !important; color: var(--text-primary) !important; }
    /* Replace explicit white inline background-color variants */
    [data-theme="dark"] [style*="background-color: #fff"],
    [data-theme="dark"] [style*="background-color:#fff"],
    [data-theme="dark"] [style*="background: #ffffff"],
    [data-theme="dark"] [style*="background:#ffffff"],
    [data-theme="dark"] [style*="background-color: white"] {
      background: rgba(255,255,255,0.02) !important;
      color: var(--text-primary) !important;
    /* Print helpers: ensure printable fiches place signatures at page bottom */
    @media print {
      /* If a printable fiche uses a fixed-width container (eg. 720px), make sure it is positioned relative */
      .print-card, .print-page, [style*="min-height:820px"], .genie-print-container { position: relative !important; min-height: 100vh !important; }
      /* Force signature blocks to stick to bottom when printing */
      .genie-signatures { position: absolute !important; left: 0 !important; right: 0 !important; bottom: 24px !important; margin: 0 24px !important; }
      /* Avoid page-break inside signatures */
      .genie-signatures, .genie-signature-line { page-break-inside: avoid !important; }
    }
      border: 1px solid rgba(255,255,255,0.04) !important;
    }
    /* Ensure dark-mode text contrasts (override text-black / dark text utilities) */
    [data-theme="dark"] .text-black,
    [data-theme="dark"] .text-gray-900,
    [data-theme="dark"] .text-gray-800 {
      color: var(--text-primary) !important;
    }
    /* Specific small tiles inside cards (fallback generic selectors) */
    [data-theme="dark"] .card .small-tile,
    [data-theme="dark"] .card .stat-tile,
    [data-theme="dark"] .small-box,
    [data-theme="dark"] .tile {
      background: rgba(255,255,255,0.02) !important;
      color: var(--text-primary) !important;
      border: 1px solid rgba(255,255,255,0.04) !important;
      box-shadow: none !important;
    }

    /* Ensure generic badges and pills are readable in dark mode (keep semantic badges separate) */
    [data-theme="dark"] .badge,
    [data-theme="dark"] .pill,
    [data-theme="dark"] .statut-label,
    [data-theme="dark"] .level-count {
      background: rgba(255,255,255,0.03) !important;
      color: var(--text-primary) !important;
      border: 1px solid rgba(255,255,255,0.06) !important;
      box-shadow: none !important;
      padding: .25rem .6rem !important;
      border-radius: 999px !important;
      font-weight: 600 !important;
      font-size: 0.85rem !important;
    }

    /* Semantic badge colors in dark mode — keep strong contrast like in light theme */
    [data-theme="dark"] .badge-paid {
      background: linear-gradient(90deg,#065f46,#10b981) !important;
      color: #ffffff !important;
      border: none !important;
      padding: .35rem .7rem !important;
      box-shadow: 0 6px 14px rgba(6,95,70,0.12) !important;
    }
    [data-theme="dark"] .badge-partial {
      background: linear-gradient(90deg,#92400e,#fb923c) !important;
      color: #ffffff !important;
      border: none !important;
      padding: .35rem .7rem !important;
      box-shadow: 0 6px 14px rgba(146,64,14,0.10) !important;
    }
    [data-theme="dark"] .badge-due {
      background: linear-gradient(90deg,#7f1d1d,#ef4444) !important;
      color: #ffffff !important;
      border: none !important;
      padding: .35rem .7rem !important;
      box-shadow: 0 6px 14px rgba(127,29,29,0.12) !important;
    }

    /* Status classes used in students/enseignants/inscriptions */
    [data-theme="dark"] .status-actif,
    [data-theme="dark"] .status-inactif {
      padding: .35rem .7rem !important;
      border-radius: 999px !important;
      font-weight: 600 !important;
      font-size: 0.85rem !important;
      border: none !important;
    }
    [data-theme="dark"] .status-actif { background: linear-gradient(90deg,#065f46,#10b981) !important; color: #ffffff !important; }
    [data-theme="dark"] .status-inactif { background: linear-gradient(90deg,#7f1d1d,#ef4444) !important; color: #ffffff !important; }

    /* Balance / solde visual indicator (remaining fee) — match light-mode amber but increase contrast for dark bg */
    [data-theme="dark"] .balance-solde,
    [data-theme="dark"] .solde {
      background: linear-gradient(90deg,#92400e,#fb923c) !important;
      color: #ffffff !important;
      border: none !important;
      padding: .35rem .7rem !important;
      box-shadow: 0 6px 14px rgba(146,64,14,0.12) !important;
    }
    
      /* Force frais restant (remaining fees) to use app green so it matches light theme semantics but stays visible */
      [data-theme="dark"] .frais-restant,
      [data-theme="dark"] .remaining-amount,
      [data-theme="dark"] .remaining-green,
      [data-theme="dark"] .solde-positif,
      [data-theme="dark"] .balance-solde-positive {
        background: linear-gradient(90deg,var(--app-green),var(--app-green-2)) !important;
        color: #ffffff !important;
        border: none !important;
        padding: .35rem .6rem !important;
        font-weight:700 !important;
        box-shadow: 0 8px 20px rgba(6,95,70,0.12) !important;
      }
    
      /* Inscription status: ensure enrolled/inscrit badges are visible and prominent */
      [data-theme="dark"] .inscription-status,
      [data-theme="dark"] .inscription-badge,
      [data-theme="dark"] .status-inscrit,
      [data-theme="dark"] .status-enrolled,
      [data-theme="dark"] .statut-inscrit {
        padding: .32rem .65rem !important;
        border-radius: 999px !important;
        font-weight: 700 !important;
        font-size: 0.85rem !important;
        color: #ffffff !important;
        border: none !important;
        box-shadow: 0 8px 20px rgba(0,0,0,0.45) !important;
      }
      [data-theme="dark"] .inscription-status.inscrit, [data-theme="dark"] .status-inscrit.inscrit {
        background: linear-gradient(90deg,var(--app-green),var(--app-green-2)) !important;
      }
      [data-theme="dark"] .inscription-status.attente, [data-theme="dark"] .status-inscrit.attente, [data-theme="dark"] .inscription-badge.attente {
        background: linear-gradient(90deg,#92400e,#fb923c) !important; /* waiting / partial */
      }
      [data-theme="dark"] .inscription-status.annule, [data-theme="dark"] .status-inscrit.annule {
        background: linear-gradient(90deg,#7f1d1d,#ef4444) !important; /* cancelled */
      }
    
      /* Also neutralize some inline light-green backgrounds to use app green gradient */
      [data-theme="dark"] [style*="#dcfce7"],
      [data-theme="dark"] [style*="#bbf7d0"],
      [data-theme="dark"] [style*="#bbf7d0"] {
        background: linear-gradient(90deg,var(--app-green),var(--app-green-2)) !important;
        color: #ffffff !important;
        border: none !important;
      }

    /* Icon-only and action buttons (print, delete, solde, etc.) */
    [data-theme="dark"] .action-icon-btn,
    [data-theme="dark"] .icon-btn,
    [data-theme="dark"] .row-print-btn,
    [data-theme="dark"] .print-btn,
    [data-theme="dark"] .action-print,
    [data-theme="dark"] .print-option,
    [data-theme="dark"] .btn-white,
    [data-theme="dark"] .btn-secondary,
    [data-theme="dark"] .modal-action-btn.secondary,
    [data-theme="dark"] .modal-action-btn.primary,
    [data-theme="dark"] .modal-action-btn {
      background: rgba(255,255,255,0.02) !important;
      color: var(--text-primary) !important;
      border: 1px solid rgba(255,255,255,0.06) !important;
      box-shadow: none !important;
    }

    /* Danger / Supprimer buttons should keep a subtle red tint but remain readable */
    [data-theme="dark"] .btn-danger,
    [data-theme="dark"] .delete-btn,
    [data-theme="dark"] .action-delete {
      background: linear-gradient(90deg, rgba(239,68,68,0.12), rgba(239,68,68,0.06)) !important;
      color: #fff5f5 !important;
      border: 1px solid rgba(239,68,68,0.18) !important;
      box-shadow: none !important;
    }

    /* Ensure material icons inside action buttons are visible */
    [data-theme="dark"] .action-icon-btn .material-icons,
    [data-theme="dark"] .icon-btn .material-icons,
    [data-theme="dark"] .row-print-btn .material-icons,
    [data-theme="dark"] .delete-btn .material-icons,
    [data-theme="dark"] .action-print .material-icons {
      color: var(--text-primary) !important;
      filter: brightness(1.05) !important;
    }

    /* Map utility text-white to readable color in dark mode (templates may use this) */
    [data-theme="dark"] .text-white {
      color: var(--text-primary) !important;
    }
    /* Strong modal/popup contrast and readable controls in dark mode */
    [data-theme="dark"] .modal-overlay { background: rgba(1,2,6,0.86) !important; backdrop-filter: none !important; }
    [data-theme="dark"] .modal { max-width: 820px; padding: 28px !important; border-radius: 12px !important; background: linear-gradient(180deg, rgba(255,255,255,0.045), rgba(255,255,255,0.025)) !important; border: 1px solid rgba(255,255,255,0.08) !important; box-shadow: 0 40px 120px rgba(0,0,0,0.8) !important; z-index: 10001 !important; }
    [data-theme="dark"] .modal .modal-header { border-bottom: 1px solid rgba(255,255,255,0.04) !important; padding-bottom: 12px !important; margin-bottom: 14px !important; }
    [data-theme="dark"] .modal .modal-title { color: var(--text-primary) !important; font-weight:700 !important; font-size:1.15rem !important; }
    [data-theme="dark"] .modal .modal-body { color: var(--text-secondary) !important; max-height: 65vh; overflow:auto; padding-right: 8px !important; }
    [data-theme="dark"] .modal .modal-footer { border-top: 1px solid rgba(255,255,255,0.03) !important; padding-top: 12px !important; margin-top: 14px !important; display:flex; gap:8px; justify-content:flex-end; }

    /* Inputs / selects inside modals: make fields darker and text readable */
    [data-theme="dark"] .modal input, [data-theme="dark"] .modal textarea, [data-theme="dark"] .modal select, [data-theme="dark"] .modal .form-control {
      background: rgba(0,0,0,0.22) !important; /* subtle dark field */
      color: var(--text-primary) !important;
      border: 1px solid rgba(255,255,255,0.06) !important;
      box-shadow: none !important;
      padding: .5rem .7rem !important;
    }
    [data-theme="dark"] .modal input::placeholder, [data-theme="dark"] .modal textarea::placeholder { color: rgba(230,238,248,0.6) !important; }
    [data-theme="dark"] .modal label, [data-theme="dark"] .modal .label { color: var(--text-primary) !important; font-weight:600 !important; }

    /* Make modal close button / small icons visible */
    [data-theme="dark"] .modal .close-btn, [data-theme="dark"] .modal .btn-close, [data-theme="dark"] .modal .material-icons.close {
      background: rgba(255,255,255,0.03) !important; color: var(--text-primary) !important; border: 1px solid rgba(255,255,255,0.06) !important; box-shadow: none !important;
    }

    /* Scrollbar inside modal body */
    [data-theme="dark"] .modal .modal-body::-webkit-scrollbar { width: 12px; }
    [data-theme="dark"] .modal .modal-body::-webkit-scrollbar-track { background: rgba(255,255,255,0.02); border-radius: 8px; }
    [data-theme="dark"] .modal .modal-body::-webkit-scrollbar-thumb { background: linear-gradient(180deg, rgba(124,58,237,0.22), rgba(6,182,212,0.12)); border-radius: 8px; border: 2px solid rgba(0,0,0,0.12); }

    /* Ensure small help/muted text in modals is visible (no collapse into background) */
    [data-theme="dark"] .modal small, [data-theme="dark"] .modal .muted, [data-theme="dark"] .modal .help-text { color: var(--text-secondary) !important; opacity: 1 !important; }

    /* If any inline translucent white is present in modals, strengthen it */
    [data-theme="dark"] .modal [style*="background: rgba(255,255,255,0.02)"],
    [data-theme="dark"] .modal [style*="background: rgba(255,255,255,0.03)"] {
      background: rgba(255,255,255,0.045) !important; color: var(--text-primary) !important;
    }
    /* ==================== Additional fixes for visibility in dark mode ==================== */
    /* Make modals/popups the visually dominant elements */
    [data-theme="dark"] .modal-overlay {
      background: rgba(0,0,0,0.90) !important; /* strongest dark backdrop to contrast popups */
      backdrop-filter: none !important; -webkit-backdrop-filter: none !important;
      z-index: 9998 !important;
    }
    /* Defensive: ensure any modal-backdrop used in templates is also non-blurring */
    [data-theme="dark"] .modal-backdrop, [data-theme="dark"] .modal-backdrop * {
      backdrop-filter: none !important; -webkit-backdrop-filter: none !important; filter: none !important;
    }
    [data-theme="dark"] .modal, [data-theme="dark"] .popup {
      /* Force opaque/darker modal surface to prevent background bleed-through */
      background: rgba(10,10,12,0.98) !important;
      color: var(--text-primary) !important;
      box-shadow: 0 30px 80px rgba(0,0,0,0.75) !important;
      border: 1px solid rgba(255,255,255,0.06) !important;
      z-index: 9999 !important;
      transform: translateZ(0); /* avoid blending with background */
    }
    /* Also ensure modal inner cards/panels are opaque */
    [data-theme="dark"] .modal .bg-white, [data-theme="dark"] .modal-card, [data-theme="dark"] .modal > div, [data-theme="dark"] .modal * {
      background: rgba(10,10,12,0.98) !important;
      color: var(--text-primary) !important;
    }
    /* Also cover cases where the inner popup doesn't use the .modal class but is placed inside .modal-backdrop (many templates use bg-white on the inner panel) */
    [data-theme="dark"] .modal-backdrop .bg-white,
    [data-theme="dark"] .modal-backdrop > div,
    [data-theme="dark"] .modal-backdrop div,
    [data-theme="dark"] .modal-backdrop form {
      background: rgba(10,10,12,0.98) !important;
      color: var(--text-primary) !important;
      border: 1px solid rgba(255,255,255,0.04) !important;
      box-shadow: 0 30px 80px rgba(0,0,0,0.75) !important;
    }
    [data-theme="dark"] .modal h1, [data-theme="dark"] .modal h2, [data-theme="dark"] .modal h3, [data-theme="dark"] .modal label, [data-theme="dark"] .modal p {
      color: var(--text-primary) !important;
    }
    [data-theme="dark"] .modal .btn-primary, [data-theme="dark"] .popup .btn-primary {
      background: linear-gradient(90deg,var(--accent-2),var(--accent-1)) !important;
      color: #fff !important;
      box-shadow: 0 8px 30px rgba(124,58,237,0.18) !important;
    }

    /* Ensure modal action text/icons are visible */
    [data-theme="dark"] .modal .material-icons, [data-theme="dark"] .popup .material-icons {
      color: var(--text-primary) !important; filter: brightness(1.1) !important;
    }

    /* Important: stronger status mappings for any variant names used across templates */
    [data-theme="dark"] .status-actif, [data-theme="dark"] .status-active, [data-theme="dark"] .is-active, [data-theme="dark"] .statut-actif, [data-theme="dark"] .badge-success {
      background: linear-gradient(90deg,#065f46,#10b981) !important; color: #ffffff !important; border: none !important; box-shadow: 0 8px 20px rgba(6,95,70,0.12) !important;
    }
    [data-theme="dark"] .status-inactif, [data-theme="dark"] .status-inactive, [data-theme="dark"] .badge-failed, [data-theme="dark"] .badge-danger {
      background: linear-gradient(90deg,#7f1d1d,#ef4444) !important; color: #ffffff !important; border: none !important; box-shadow: 0 8px 20px rgba(127,29,29,0.12) !important;
    }

    /* ======================================================================= */
    /* Ensure frais restant (remaining fees) use clear semantic colors in dark */
    /* Positive balances (overpaid / credit) -> green (value < 0 or credited) */
    [data-theme="dark"] .balance-credite, /* produced when value < 0 */
    [data-theme="dark"] .solde-positif,
    [data-theme="dark"] .remaining-amount.positive,
    [data-theme="dark"] .remaining-green {
      background: linear-gradient(90deg,#065f46,#10b981) !important;
      color: #ffffff !important;
      border: none !important;
      padding: .35rem .6rem !important;
      font-weight:700 !important;
      box-shadow: 0 8px 20px rgba(6,95,70,0.14) !important;
    }

    /* Negative balances (student owes) -> use amber same as light theme (value > 0) */
    [data-theme="dark"] .balance-solde, /* produced when value > 0 */
    [data-theme="dark"] .solde-negatif,
    [data-theme="dark"] .remaining-amount.negative {
      background: linear-gradient(90deg,#92400e,#fb923c) !important;
      color: #ffffff !important;
      border: none !important;
      padding: .35rem .6rem !important;
      font-weight:700 !important;
      box-shadow: 0 8px 20px rgba(146,64,14,0.14) !important;
    }

    /* Neutral / réglé */
    [data-theme="dark"] .balance-regle, [data-theme="dark"] .balance-regle span {
      background: rgba(255,255,255,0.03) !important;
      color: var(--text-secondary) !important;
      border: 1px solid rgba(255,255,255,0.04) !important;
      padding: .25rem .5rem !important;
      font-weight:700 !important;
    }

    /* Make inscription status badges as prominent as student status badges (parity) */
    [data-theme="dark"] .status-inscrit, [data-theme="dark"] .status-actif, [data-theme="dark"] .statut-inscrit, [data-theme="dark"] .inscription-status {
      background: linear-gradient(90deg,#065f46,#10b981) !important;
      color: #ffffff !important;
      border: none !important;
      box-shadow: 0 8px 20px rgba(6,95,70,0.12) !important;
      padding: .32rem .65rem !important;
      border-radius: 999px !important;
      font-weight:700 !important;
      font-size: 0.85rem !important;
    }
    [data-theme="dark"] .status-autre, [data-theme="dark"] .status-inactif, [data-theme="dark"] .status-autre, [data-theme="dark"] .status-annule {
      background: linear-gradient(90deg,#7f1d1d,#ef4444) !important;
      color: #ffffff !important;
      border: none !important;
      box-shadow: 0 8px 20px rgba(127,29,29,0.12) !important;
      padding: .32rem .65rem !important;
      border-radius: 999px !important;
      font-weight:700 !important;
      font-size: 0.85rem !important;
    }

    /* Remaining fee / solde: ensure credited amounts are green and owed amounts are red */
    [data-theme="dark"] .remaining-amount, [data-theme="dark"] .remaining-green, [data-theme="dark"] .solde-positif, [data-theme="dark"] .balance-credite, [data-theme="dark"] .solde {
      /* default: prefer green for credited amounts when class is balance-credite; owed items use balance-solde (red) */
      background: linear-gradient(90deg,#065f46,#10b981) !important;
      color: #ffffff !important;
      border: none !important;
      padding: .35rem .6rem !important;
      font-weight:700 !important;
      box-shadow: 0 8px 20px rgba(6,95,70,0.12) !important;
    }

    /* Neutralize common pale-light-green inline colors (tailwind/light theme greens) so they become strong in dark mode */
    [data-theme="dark"] [style*="#ecfdf5"],
    [data-theme="dark"] [style*="#dcfce7"],
    [data-theme="dark"] [style*="#bbf7d0"],
    [data-theme="dark"] [style*="#10b981"],
    [data-theme="dark"] [style*="#16a34a"],
    [data-theme="dark"] [style*="#059669"] {
      background: linear-gradient(90deg,#065f46,#10b981) !important;
      color: #ffffff !important;
      border: none !important;
      box-shadow: 0 6px 18px rgba(6,95,70,0.10) !important;
    }

    /* Ensure pop-up close / action buttons remain visible */
    [data-theme="dark"] .modal .btn-secondary, [data-theme="dark"] .modal .btn-white {
      background: rgba(255,255,255,0.03) !important; color: var(--text-primary) !important; border: 1px solid rgba(255,255,255,0.06) !important;
    }

    /* Reduce chance of modal text collapsing into background: increase contrast on small text */
    [data-theme="dark"] .modal small, [data-theme="dark"] .modal .muted, [data-theme="dark"] .popup small, [data-theme="dark"] .popup .muted {
      color: var(--text-secondary) !important; opacity: 1 !important;
    }
    /* ======================================================================================= */
    /* Mobile adjustments: make sidebar off-canvas and provide space for a bottom nav */
    @media (max-width: 640px) {
      /* keep the visual separator hidden on small screens */
      .nav-separator { display: none !important; }
      /* reserve space for the bottom navigation */
      #mainContent { padding-bottom: 88px !important; margin-left: 0 !important; }
      main.main-content { padding-bottom: 100px !important; }

      /* off-canvas sidebar (hidden by transform by default, slides in when .open is added) */
      .sidebar {
        position: fixed !important;
        top: 0;
        left: 0;
        bottom: 0;
        width: 280px;
        z-index: 60;
        transform: translateX(-110%);
        transition: transform 320ms cubic-bezier(.2,.9,.25,1);
        display: flex !important;
        box-shadow: 0 20px 50px rgba(0,0,0,0.32);
        background: var(--bg-primary);
      }
      .sidebar.open { transform: translateX(0); }

      /* backdrop that dims the page when sidebar is open */
      .mobile-backdrop {
        position: fixed; inset: 0; z-index: 55;
        background: rgba(0,0,0,0.45);
        opacity: 0; pointer-events: none; transition: opacity 180ms ease-in-out;
      }
      .mobile-backdrop.visible { opacity: 1; pointer-events: auto; }
    }
  </style>

  <style>
    /* Helpers for auth / login pages: hide sidebar and center main area when body has .auth-page */
    body.auth-page .sidebar, body.auth-page .nav-separator { display: none !important; }
    body.auth-page .main-content { margin-left: 0 !important; }
    body.auth-page main { padding: 2rem !important; display: flex; align-items: center; justify-content: center; }
    body.auth-page .auth-container { width: 100%; max-width: 1200px; }
  </style>

</head>
<body class="flex h-screen {% block body_class %}{% endblock %}">
  <aside id="sidebar" class="w-64 sidebar flex flex-col p-4">
    <div class="flex items-center mb-10">
    {% if school_logo %}
      <img src="{{ school_logo }}" alt="GénieSchool" class="w-16 h-16 rounded-lg object-cover mr-3 shadow-sm" style="flex-shrink:0;" />
    {% else %}
      {% if school_logo %}
        <img src="{{ school_logo }}" alt="GénieSchool" class="w-16 h-16 rounded-lg object-cover mr-3 shadow-sm" style="flex-shrink:0;" />
      {% else %}
        <img src="{% static 'school_logo.png' %}" alt="GénieSchool" class="w-16 h-16 rounded-lg object-cover mr-3 shadow-sm" style="flex-shrink:0;" />
      {% endif %}
    {% endif %}
      <div class="logo-text">
        <h1 class="text-xl font-bold">GénieSchool</h1>
        <p class="text-sm">Excellence en Formation</p>
      </div>
    </div>
  <!-- Animated nav indicator (moves to hovered/active link) -->
  <div id="navIndicator" class="nav-indicator" aria-hidden="true"></div>
    <nav class="flex-grow">
      {% url 'dashboard' as dashboard_url %}
      {% url 'etudiants' as etu_url %}
  {% url 'formateurs' as form_url %}
  {% url 'enseignants' as enseignants_url %}
      {% url 'formations' as formations_url %}
      {% url 'planning' as planning_url %}
  {% url 'presence' as presence_url %}
      {% url 'examens' as examens_url %}
  {% url 'inscriptions' as inscriptions_url %}
      {% url 'finances' as finances_url %}
  {% url 'paiements' as paiements_url %}
      {% url 'reglements_enseignants' as reglements_enseignants_url %}
      {% url 'reglements_fournisseurs' as reglements_fournisseurs_url %}
      {% url 'rapports' as rapports_url %}
      <ul>
        <li class="mb-4">
          <a href="{{ dashboard_url }}" class="flex items-center px-4 py-2 rounded-lg {% if request.path == dashboard_url %}active-link{% endif %}">
            <span class="material-icons mr-3">dashboard</span> Tableau de bord
          </a>
        </li>
        <li class="mb-4">
          <div class="group-header px-4 py-2 rounded-lg flex items-center justify-between {% if request.path == etu_url or request.path == inscriptions_url %}active-link{% endif %}">
            <div class="flex items-center">
              <span class="material-icons mr-3">people</span>
              <span>Étudiants</span>
            </div>
            <span class="material-icons text-gray-400">expand_more</span>
          </div>
          <ul class="mt-2 submenu {% if request.path == etu_url or request.path == inscriptions_url %}open{% endif %}">
            <li class="mb-2">
              <a href="{{ etu_url }}" class="{% if request.path == etu_url %}active-link{% endif %}">
                <span class="material-icons mr-3 text-sm" style="vertical-align:middle;">people</span>
                <span>Liste des étudiants</span>
              </a>
            </li>
            <li>
              <a href="{{ inscriptions_url }}" class="{% if request.path == inscriptions_url %}active-link{% endif %}">
                <span class="material-icons mr-3 text-sm" style="vertical-align:middle;">how_to_reg</span>
                <span>Liste des inscriptions</span>
              </a>
            </li>
          </ul>
        </li>
        <li class="mb-4">
          <a href="{{ enseignants_url }}" class="flex items-center px-4 py-2 rounded-lg {% if request.path == form_url or request.path == enseignants_url %}active-link{% endif %}">
            <span class="material-icons mr-3">supervisor_account</span> Enseignant
          </a>
        </li>
        <li class="mb-4">
          <a href="{{ formations_url }}" class="flex items-center px-4 py-2 rounded-lg {% if request.path == formations_url %}active-link{% endif %}">
            <span class="material-icons mr-3">school</span> Formations
          </a>
        </li>
        <li class="mb-4">
          <a href="{{ planning_url }}" class="flex items-center px-4 py-2 rounded-lg {% if request.path == planning_url %}active-link{% endif %}">
            <span class="material-icons mr-3">event</span> Planning
          </a>
        </li>
        <li class="mb-4">
          <a href="{{ presence_url }}" class="flex items-center px-4 py-2 rounded-lg {% if request.path == presence_url %}active-link{% endif %}">
            <span class="material-icons mr-3">visibility</span> Présence
          </a>
        </li>
        <li class="mb-4">
          <a href="{{ examens_url }}" class="flex items-center px-4 py-2 rounded-lg {% if request.path == examens_url %}active-link{% endif %}">
            <span class="material-icons mr-3">assignment</span> Examens
          </a>
        </li>
        
        <li class="mb-4">
          <div class="group-header">
            <a href="{{ finances_url }}" class="flex items-center px-4 py-2 rounded-lg justify-between {% if request.path == finances_url %}active-link{% endif %}">
              <div class="flex items-center">
                <span class="material-icons mr-3">payments</span>
                <span>Finances</span>
              </div>
              <span class="material-icons text-gray-400">expand_more</span>
            </a>
          </div>
          <ul class="mt-2 submenu {% if request.path == finances_url or request.path == paiements_url or request.path == reglements_fournisseurs_url %}open{% endif %}">
            
            <li class="mb-2">
              <a href="{{ reglements_fournisseurs_url }}" class="{% if request.path == reglements_fournisseurs_url %}active-link{% endif %}">
                <span class="material-icons mr-3 text-sm" style="vertical-align:middle;">storefront</span>
                <span>Fournisseurs</span>
              </a>
            </li>
            <li class="mb-2">
              {% url 'charges' as charges_url %}
              <a href="{{ charges_url }}" class="{% if request.path == charges_url %}active-link{% endif %}">
                <span class="material-icons mr-3 text-sm" style="vertical-align:middle;">receipt_long</span>
                <span>Charges</span>
              </a>
            </li>
            <li>
              <a href="#">
                <span class="material-icons mr-3 text-sm" style="vertical-align:middle;">savings</span>
                <span>Trésor</span>
              </a>
            </li>
          </ul>
        </li>
        <li class="mb-4">
          <a href="/parametres/" class="flex items-center px-4 py-2 rounded-lg {% if '/parametres' in request.path %}active-link{% endif %}">
            <span class="material-icons mr-3">settings</span> Paramètres
          </a>
        </li>
        <li>
          <a href="{{ rapports_url }}" class="flex items-center px-4 py-2 rounded-lg {% if request.path == rapports_url %}active-link{% endif %}">
            <span class="material-icons mr-3">bar_chart</span> Rapports
          </a>
        </li>
      </ul>
    </nav>
   
      <div class="relative">
        {% comment %} Animated colored SVG avatar that uses CSS animation and shows initials if no avatar {% endcomment %}
        <div class="flex items-center cursor-pointer" id="profileToggle">
          <div class="w-10 h-10 rounded-full flex items-center justify-center mr-3 shadow-sm profile-avatar" aria-hidden="true">
            <!-- gradient animated circle with initials -->
            <svg viewBox="0 0 40 40" width="40" height="40" class="block rounded-full">
              <defs>
                <linearGradient id="g1" x1="0%" x2="100%">
                  <stop offset="0%" stop-color="#06b6d4">
                  </stop>
                  <stop offset="100%" stop-color="#10b981">
                  </stop>
                </linearGradient>
              </defs>
              <circle cx="20" cy="20" r="20" fill="url(#g1)"></circle>
              <text x="50%" y="55%" text-anchor="middle" fill="#fff" font-size="14" font-family="Poppins, sans-serif" font-weight="700">
                {% if current_user %}
                  {% with p=current_user.prenom n=current_user.nom %}
                    {% if p %}
                      {{ p|slice:":1"|upper }}
                    {% elif n %}
                      {{ n|slice:":1"|upper }}
                    {% else %}
                      G
                    {% endif %}
                  {% endwith %}
                {% else %}
                  G
                {% endif %}
              </text>
            </svg>
          </div>
          <div class="user-info">
            <p class="font-semibold">{% if current_user %}{{ current_user.prenom }} {{ current_user.nom }}{% else %}Invité{% endif %}</p>
            <!-- role intentionally hidden per UX request -->
          </div>
        </div>

        <!-- dropdown with profile and logout -->
        <div id="profileDropdown" class="hidden absolute right-0 mt-2 w-48 bg-white card p-3 shadow-lg z-50" style="min-width:200px;">
          <div class="mb-2">
            <div class="text-sm text-gray-600">Connecté en tant</div>
            <div class="font-semibold text-sm">{% if current_user %}{{ current_user.prenom }} {{ current_user.nom }}{% else %}Invité{% endif %}</div>
            <!-- role hidden -->
          </div>
          <div class="border-t border-gray-100 mt-2 pt-2">
            <a href="/parametres/" class="block px-2 py-1 text-sm text-gray-700 hover:bg-gray-50 rounded">Profil & paramètres</a>
            <a href="{% url 'logout' %}" class="block px-2 py-1 text-sm text-red-600 hover:bg-red-50 rounded">Déconnexion</a>
          </div>
        </div>
        <style>
          /* small pulsing animation for avatar gradient */
          .profile-avatar svg circle { transform-origin: center; animation: pulse 3s infinite linear; }
          @keyframes pulse { 0% { filter: hue-rotate(0deg) saturate(1); transform: scale(1); } 50% { filter: hue-rotate(25deg) saturate(1.05); transform: scale(1.03); } 100% { filter: hue-rotate(0deg) saturate(1); transform: scale(1); } }
        </style>
        <script>
          // Robust profile dropdown: position fixed near the avatar so it won't be clipped
          document.addEventListener('DOMContentLoaded', function(){
            var toggle = document.getElementById('profileToggle');
            var dd = document.getElementById('profileDropdown');
            if(!toggle || !dd) return;

            // Move the dropdown to document.body to avoid clipping by parent containers
            try {
              if (dd.parentNode !== document.body) document.body.appendChild(dd);
            } catch (e) { /* ignore if moving fails */ }
            // Ensure dropdown has an initial style we can adjust
            dd.style.minWidth = dd.style.minWidth || '200px';
            dd.classList.add('transition-all');

            function placeDropdown() {
              // compute bounding rect of the toggle (avatar area) relative to viewport
              var rect = toggle.getBoundingClientRect();
              // prefer fixed positioning to avoid clipping by parent containers
              dd.style.position = 'fixed';
              // place the right edge of the dropdown aligned with the right edge of the avatar
              // but ensure it doesn't overflow the viewport
              var ddWidth = dd.offsetWidth || 220;
              var left = rect.right - ddWidth;
              if (left < 8) left = 8; // small padding from left edge
              // place slightly below the avatar
              var top = rect.bottom + 8;
              // if not enough space below, try place above
              if (top + dd.offsetHeight > window.innerHeight - 8) {
                top = rect.top - dd.offsetHeight - 8;
                if (top < 8) top = 8;
              }
              dd.style.left = left + 'px';
              dd.style.top = top + 'px';
            }

            function openDropdown() {
              placeDropdown();
              dd.classList.remove('hidden');
            }
            function closeDropdown() {
              dd.classList.add('hidden');
            }

            toggle.addEventListener('click', function(e){
              e.stopPropagation();
              if (dd.classList.contains('hidden')) openDropdown(); else closeDropdown();
            });

            // Click outside -> close
            document.addEventListener('click', function(e){
              if (!toggle.contains(e.target) && !dd.contains(e.target)) closeDropdown();
            });

            // Keep dropdown correctly positioned on resize/scroll when open
            window.addEventListener('resize', function(){ if (!dd.classList.contains('hidden')) placeDropdown(); });
            window.addEventListener('scroll', function(){ if (!dd.classList.contains('hidden')) placeDropdown(); }, true);
          });
        </script>
      </div>
    </div>
  </aside>
  <!-- modern visual separator between sidebar and content -->
  <div class="nav-separator" aria-hidden="true"></div>
  <main class="flex-1 p-8 overflow-y-auto main-content" style="margin-left:0;">
    {% block content %}{% endblock %}
  </main>



  <script>
    // Toggle sidebar submenu groups: click header to open/close


    
    document.addEventListener('DOMContentLoaded', function(){
        // Theme initialization and toggle
        try {
          var htmlEl = document.documentElement;
          var saved = null;
          try { saved = localStorage.getItem('theme'); } catch(e) { saved = null; }
          if (!saved) {
            saved = (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) ? 'dark' : 'light';
          }
          htmlEl.setAttribute('data-theme', saved);
          var toggle = document.getElementById('themeToggle');
          var icon = document.getElementById('themeIcon');
          var toggleSlider = document.querySelector('.toggle-slider');
          if (toggle) {
            toggle.checked = (saved === 'dark');
            // set accessible attribute
            if(toggleSlider) toggleSlider.setAttribute('aria-checked', toggle.checked ? 'true' : 'false');
            toggle.addEventListener('change', function () {
              var theme = toggle.checked ? 'dark' : 'light';
              htmlEl.setAttribute('data-theme', theme);
              try { localStorage.setItem('theme', theme); } catch(e) {}
              if (icon) icon.textContent = theme === 'dark' ? 'dark_mode' : 'light_mode';
              if(toggleSlider) toggleSlider.setAttribute('aria-checked', toggle.checked ? 'true' : 'false');
            });
          }
          if (icon) icon.textContent = (saved === 'dark') ? 'dark_mode' : 'light_mode';
        } catch(e) {}
        document.querySelectorAll('.group-header').forEach(function(h){
          h.setAttribute('role','button');
          h.setAttribute('tabindex','0');
          h.addEventListener('click', function(e){
            // if the click originated from a link inside the header, let it navigate
            if (e.target.closest('a')) return;
            var ul = h.nextElementSibling;
            if(!ul) return;
            ul.classList.toggle('open');
            h.classList.toggle('open');
            // accessibility
            var expanded = ul.classList.contains('open');
            h.setAttribute('aria-expanded', expanded ? 'true' : 'false');
            ul.setAttribute('aria-hidden', expanded ? 'false' : 'true');
          });
          h.addEventListener('keydown', function(e){ if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); h.click(); } });
        });
        // Nav indicator interactivity: move indicator to hovered/active link
        (function(){
          var indicator = document.getElementById('navIndicator');
          var aside = document.querySelector('.sidebar');
          if(!indicator || !aside) return;
          var items = Array.from(aside.querySelectorAll('a, .group-header'));
          function place(el){
            if(!el) return;
            var rect = el.getBoundingClientRect();
            var asideRect = aside.getBoundingClientRect();
            var top = rect.top - asideRect.top + (window.scrollY || 0);
            indicator.style.top = (top + 6) + 'px';
            indicator.style.height = Math.max(36, rect.height - 8) + 'px';
            indicator.style.opacity = 1;
          }
          // show indicator on hover
          items.forEach(function(it){
            it.addEventListener('mouseenter', function(){ place(it); });
          });
          // hide when leaving aside
          aside.addEventListener('mouseleave', function(){ indicator.style.opacity = 0; });
          // keep indicator on the active link if present
          var active = aside.querySelector('.active-link');
          if(active) place(active);
        })();
      });
  </script>
    <!-- Mobile backdrop and bottom nav -->
    <!-- Modern mobile navigation deployed: Dec 14, 2025 -->
    <!-- Fixed DB toggle button: decorative, animated, posts to toggle-active DB endpoint -->
    <button id="dbToggleBtn" title="Basculer la base active" aria-label="Basculer la base active" class="fixed-db-toggle" data-state="unknown">
      <span id="dbToggleIcon" class="material-icons">cached</span>
      <span id="dbToggleLabel" class="db-toggle-label">DB</span>
      <span id="dbToggleSpinner" class="db-spinner hidden" aria-hidden="true"></span>
    </button>
    <div id="mobileBackdrop" class="mobile-backdrop" aria-hidden="true"></div>
    <!-- Modern Fixed Bottom Navigation with Beautiful Colored Icons -->
    {% url 'charges' as charges_url %}
    <nav id="mobileBottomNav" class="sm:hidden fixed bottom-0 left-0 right-0 z-50 bg-gradient-to-t from-white to-gray-50 border-t border-gray-300 shadow-2xl" role="navigation" aria-label="Navigation mobile">
      <div class="flex items-center justify-around h-20 px-2">
        <a href="{{ dashboard_url }}" class="mobile-nav-item flex flex-col items-center justify-center flex-1 h-full transition-all duration-300 {% if request.path == dashboard_url %}active{% endif %}" data-page="dashboard">
          <div class="mobile-nav-icon-wrapper mb-1">
            <span class="material-icons mobile-nav-icon text-2xl">dashboard</span>
          </div>
          <span class="mobile-nav-label text-xs font-semibold">Accueil</span>
        </a>
        <a href="{{ etu_url }}" class="mobile-nav-item flex flex-col items-center justify-center flex-1 h-full transition-all duration-300 {% if request.path == etu_url %}active{% endif %}" data-page="etudiants">
          <div class="mobile-nav-icon-wrapper mb-1">
            <span class="material-icons mobile-nav-icon text-2xl">people</span>
          </div>
          <span class="mobile-nav-label text-xs font-semibold">Étudiants</span>
        </a>
        <a href="{{ inscriptions_url }}" class="mobile-nav-item flex flex-col items-center justify-center flex-1 h-full transition-all duration-300 {% if request.path == inscriptions_url %}active{% endif %}" data-page="inscriptions">
          <div class="mobile-nav-icon-wrapper mb-1">
            <span class="material-icons mobile-nav-icon text-2xl">how_to_reg</span>
          </div>
          <span class="mobile-nav-label text-xs font-semibold">Inscriptions</span>
        </a>
        <a href="{{ charges_url }}" class="mobile-nav-item flex flex-col items-center justify-center flex-1 h-full transition-all duration-300 {% if request.path == charges_url %}active{% endif %}" data-page="charges" title="Accès rapide aux charges">
          <div class="mobile-nav-icon-wrapper mb-1">
            <span class="material-icons mobile-nav-icon text-2xl">receipt_long</span>
          </div>
          <span class="mobile-nav-label text-xs font-semibold">Charges</span>
        </a>
        <button id="mobileMenuBtn" class="mobile-nav-item flex flex-col items-center justify-center flex-1 h-full transition-all duration-300" data-page="menu">
          <div class="mobile-nav-icon-wrapper mb-1">
            <span class="material-icons mobile-nav-icon text-2xl">menu</span>
          </div>
          <span class="mobile-nav-label text-xs font-semibold">Menu</span>
        </button>
      </div>
    </nav>
    <style>
      /* Beautiful Mobile Navigation Styles */
      #mobileBottomNav {
        display: flex !important;
        visibility: visible !important;
      }
      .mobile-nav-item {
        position: relative;
        color: #6b7280;
        text-decoration: none;
        border-radius: 16px 16px 0 0;
        overflow: visible;
        cursor: pointer;
        user-select: none;
      }
      
      .mobile-nav-item::before {
        content: '';
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%) scaleX(0);
        width: 40px;
        height: 3px;
        background: linear-gradient(90deg, #06b6d4, #16a34a);
        border-radius: 0 0 3px 3px;
        transition: transform 0.3s cubic-bezier(.2,.9,.25,1);
      }
      
      .mobile-nav-item.active::before {
        transform: translateX(-50%) scaleX(1);
      }
      
      .mobile-nav-icon-wrapper {
        position: relative;
        width: 52px;
        height: 52px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 14px;
        background: linear-gradient(135deg, rgba(6,182,212,0.1), rgba(22,163,74,0.1));
        transition: all 0.3s cubic-bezier(.2,.9,.25,1);
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      }
      
      .mobile-nav-item[data-page="dashboard"] .mobile-nav-icon-wrapper {
        background: linear-gradient(135deg, rgba(59,130,246,0.12), rgba(99,102,241,0.12));
      }
      
      .mobile-nav-item[data-page="etudiants"] .mobile-nav-icon-wrapper {
        background: linear-gradient(135deg, rgba(236,72,153,0.12), rgba(219,39,119,0.12));
      }
      
      .mobile-nav-item[data-page="inscriptions"] .mobile-nav-icon-wrapper {
        background: linear-gradient(135deg, rgba(16,185,129,0.12), rgba(5,150,105,0.12));
      }
      
      .mobile-nav-item[data-page="finances"] .mobile-nav-icon-wrapper {
        background: linear-gradient(135deg, rgba(245,158,11,0.12), rgba(217,119,6,0.12));
      }
      
      .mobile-nav-item[data-page="menu"] .mobile-nav-icon-wrapper {
        background: linear-gradient(135deg, rgba(139,92,246,0.12), rgba(124,58,237,0.12));
      }
      
      .mobile-nav-icon {
        transition: all 0.3s cubic-bezier(.2,.9,.25,1);
        color: #6b7280;
      }
      
      .mobile-nav-item.active .mobile-nav-icon-wrapper {
        transform: translateY(-6px) scale(1.15);
        box-shadow: 0 12px 32px rgba(0,0,0,0.18);
      }
      
      .mobile-nav-item[data-page="dashboard"].active .mobile-nav-icon-wrapper {
        background: linear-gradient(135deg, #3b82f6, #6366f1);
      }
      
      .mobile-nav-item[data-page="etudiants"].active .mobile-nav-icon-wrapper {
        background: linear-gradient(135deg, #ec4899, #db2777);
      }
      
      .mobile-nav-item[data-page="inscriptions"].active .mobile-nav-icon-wrapper {
        background: linear-gradient(135deg, #10b981, #059669);
      }
      
      .mobile-nav-item[data-page="finances"].active .mobile-nav-icon-wrapper {
        background: linear-gradient(135deg, #f59e0b, #d97706);
      }
      
      .mobile-nav-item[data-page="menu"].active .mobile-nav-icon-wrapper {
        background: linear-gradient(135deg, #8b5cf6, #7c3aed);
      }
      
      .mobile-nav-item.active .mobile-nav-icon {
        color: #ffffff;
        transform: scale(1.1);
      }
      
      .mobile-nav-item.active .mobile-nav-label {
        color: #0f172a;
        font-weight: 700;
      }
      
      .mobile-nav-item:active {
        transform: scale(0.95);
      }
      
      /* Pulse animation for active items */
      @keyframes navPulse {
        0%, 100% { transform: translateY(-4px) scale(1.1); }
        50% { transform: translateY(-6px) scale(1.15); }
      }
      
      .mobile-nav-item.active .mobile-nav-icon-wrapper {
        animation: navPulse 2s ease-in-out infinite;
      }
      
      /* Hover effects for larger touch targets */
      @media (hover: hover) {
        .mobile-nav-item:hover .mobile-nav-icon-wrapper {
          transform: translateY(-2px) scale(1.05);
        }
      }
    </style>
    <script>
      // mobile nav toggle handlers
      document.addEventListener('DOMContentLoaded', function(){
    var sidebarEl = document.getElementById('sidebar') || document.querySelector('.sidebar');
    var backdrop = document.getElementById('mobileBackdrop');
    var menuBtn = document.getElementById('mobileMenuBtn') || document.getElementById('openSidebar');
        if(!sidebarEl || !backdrop || !menuBtn) return;

        function openSidebar(){ 
          sidebarEl.classList.add('open'); 
          backdrop.classList.add('visible'); 
          document.body.style.overflow = 'hidden';
          // Add smooth entrance animation
          setTimeout(function() {
            sidebarEl.style.transition = 'transform 320ms cubic-bezier(.2,.9,.25,1)';
          }, 10);
        }
        function closeSidebar(){ 
          sidebarEl.classList.remove('open'); 
          backdrop.classList.remove('visible'); 
          document.body.style.overflow = '';
        }

        menuBtn.addEventListener('click', function(e){ e.preventDefault(); e.stopPropagation(); openSidebar(); });
        backdrop.addEventListener('click', function(){ closeSidebar(); });

        // Close sidebar when a nav link is clicked (mobile)
        sidebarEl.querySelectorAll('a').forEach(function(a){ a.addEventListener('click', function(){ closeSidebar(); }); });
        
        // Add touch swipe to close sidebar
        var touchStartX = 0;
        var touchEndX = 0;
        sidebarEl.addEventListener('touchstart', function(e) {
          touchStartX = e.changedTouches[0].screenX;
        });
        sidebarEl.addEventListener('touchend', function(e) {
          touchEndX = e.changedTouches[0].screenX;
          if (touchStartX - touchEndX > 50) {
            closeSidebar();
          }
        });
      });
    </script>
    <script>
      // Hide the mobile bottom nav whenever a modal-backdrop is visible (e.g. add/edit popups).
      // This central approach avoids duplicating logic across templates and works for any modal.
      (function(){
        function isModalVisible(){
          try{
            var modals = document.querySelectorAll('.modal-backdrop');
            for(var i=0;i<modals.length;i++){
              var m = modals[i];
              // consider visible if not having 'hidden' class and computed display is not 'none'
              var style = window.getComputedStyle(m);
              if(!m.classList.contains('hidden') && style.display !== 'none' && style.visibility !== 'hidden' && style.opacity !== '0') return true;
            }
          }catch(e){}
          return false;
        }

        function setMobileNavHidden(hide){
          var nav = document.getElementById('mobileBottomNav');
          if(!nav) return;
          if(typeof nav.dataset._origDisplay === 'undefined'){
            nav.dataset._origDisplay = nav.style.display || window.getComputedStyle(nav).display || '';
          }
          if(hide){ nav.style.display = 'none'; }
          else { nav.style.display = nav.dataset._origDisplay || ''; }
        }

        // Observe DOM changes to detect when modals are opened/closed and update nav visibility.
        document.addEventListener('DOMContentLoaded', function(){
          // initial state
          setMobileNavHidden(isModalVisible());
          var mo = new MutationObserver(function(){ setMobileNavHidden(isModalVisible()); });
          mo.observe(document.body, { attributes: true, childList: true, subtree: true });
          // also react to window resize/orientation changes
          window.addEventListener('resize', function(){ setMobileNavHidden(isModalVisible()); });
        });
      })();
    </script>
    <style>
      /* Fixed DB toggle button styles (appended at end to avoid interfering with existing rules) */
      .fixed-db-toggle {
        position: fixed;
        right: 20px;
        bottom: 96px;
        z-index: 110;
        width: 56px;
        height: 56px;
        border-radius: 999px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        padding: 0.5rem;
        background: linear-gradient(90deg,var(--app-green),var(--app-green-2));
        color: #fff;
        border: none;
        box-shadow: 0 12px 30px rgba(6,95,70,0.18);
        cursor: pointer;
        transition: transform 180ms ease, box-shadow 180ms ease, opacity 160ms;
        font-weight:700;
      }
      .fixed-db-toggle:active { transform: scale(0.96); }
      .fixed-db-toggle .material-icons { font-size: 20px; }
      .fixed-db-toggle .db-toggle-label { display: none; font-size: 12px; }
      .db-spinner { width: 18px; height: 18px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.22); border-top-color: #fff; animation: spin 900ms linear infinite; margin-left:6px; }
      .db-spinner.hidden { display: none; }
      @keyframes spin { to { transform: rotate(360deg); } }
      .fixed-db-toggle.active { box-shadow: 0 18px 40px rgba(6,182,146,0.22); transform: translateY(-4px); }
      @media (max-width: 640px) { .fixed-db-toggle { right: 12px; bottom: 112px; width:48px; height:48px; } }
    </style>
    <script>
      (function(){
        function getCookie(name){ var v = document.cookie.match('(^|;)\\s*' + name + '\\s*=\\s*([^;]+)'); return v ? v.pop() : ''; }
        document.addEventListener('DOMContentLoaded', function(){
          try{
            var btn = document.getElementById('dbToggleBtn'); if(!btn) return;
            var spinner = document.getElementById('dbToggleSpinner');
            var icon = document.getElementById('dbToggleIcon');
            var label = document.getElementById('dbToggleLabel');
            var toggleUrl = '{% url "toggle_active_db" %}';
            function setLoading(on){ if(on){ spinner.classList.remove('hidden'); btn.disabled = true; btn.style.opacity = 0.9; } else { spinner.classList.add('hidden'); btn.disabled = false; btn.style.opacity = 1; } }
            function reflectStateFromCookie(){ var c = document.cookie.match('(^|;)\\s*active_db\\s*=\\s*([^;]+)'); if(c && c[2]){ btn.dataset.state = c[2]; btn.classList.add('active'); label.textContent = c[2]; } }
            reflectStateFromCookie();
            btn.addEventListener('click', function(e){ e.preventDefault(); setLoading(true); fetch(toggleUrl, { method: 'POST', headers: { 'Accept': 'application/json', 'X-CSRFToken': getCookie('csrftoken'), 'Content-Type': 'application/x-www-form-urlencoded' }, body: '' }).then(function(resp){ return resp.json(); }).then(function(json){ setLoading(false); if(json && json.ok){ var name = json.active_db || json.active_db_name || json.active_db_alias || ''; if(name){ btn.dataset.state = name; label.textContent = name; btn.classList.add('active'); } icon.textContent = 'check_circle'; setTimeout(function(){ icon.textContent = 'cached'; }, 1200); // redirect to login so user is re-authenticated for the selected DB
                  setTimeout(function(){ window.location.href = '{% url "login" %}'; }, 600);
                } else { icon.textContent = 'error'; setTimeout(function(){ icon.textContent = 'cached'; }, 1400); } }).catch(function(err){ setLoading(false); icon.textContent = 'error'; setTimeout(function(){ icon.textContent = 'cached'; }, 1400); }); });
          }catch(e){ console.warn('DB toggle init failed', e); }
        });
      })();
    </script>
    <script>
      // If the active_db cookie indicates the 'langues' DB, apply an orange theme and show a large banner
      (function(){
        function getCookie(name){ var v = document.cookie.match('(^|;)\\s*' + name + '\\s*=\\s*([^;]+)'); return v ? v.pop() : ''; }
        document.addEventListener('DOMContentLoaded', function(){
          try{
            var active = getCookie('active_db') || '';
            // treat alias 'schooloctobre' (bdlangue) as the langues DB
            if(active.toLowerCase() === 'schooloctobre' || active.toLowerCase().indexOf('lang') !== -1 || active.toLowerCase().indexOf('bdlangue') !== -1){
              // add a class to html to override CSS variables
              document.documentElement.classList.add('db-langues');
              // create a prominent banner informing the user
              var banner = document.createElement('div');
              
             
              document.body.insertBefore(banner, document.body.firstChild);
            }
          }catch(e){ console.warn('db-langues banner init failed', e); }
        });
      })();
    </script>
    <style>
      /* Orange / langues theme overrides when html has class .db-langues */
      html.db-langues { --app-green: #fb923c; --app-green-2: #f97316; --accent-1: #fb923c; --accent-2: #f97316; --bg-primary: #fff7ed; --bg-card: #fffaf0; --text-primary: #7c2d12; }
      /* Sidebar (left navbar) adjustments when on bdlangues: dark gray variant */
      html.db-langues { --bg-sidebar: linear-gradient(180deg,#374151,#4b5563); --sidebar-text: #f8fafc; --sidebar-muted: #e5e7eb; --sidebar-border: rgba(255,255,255,0.04); }
      html.db-langues .sidebar {
        background: var(--bg-sidebar) !important;
        color: var(--sidebar-text) !important;
        border-right: 1px solid var(--sidebar-border) !important;
      }
      html.db-langues .sidebar .logo-text h1 { color: var(--sidebar-text) !important; }
      html.db-langues .sidebar .logo-text p { color: var(--sidebar-muted) !important; }
      html.db-langues .sidebar a { color: var(--sidebar-muted) !important; }
      html.db-langues .sidebar a.active-link, html.db-langues .sidebar a:hover { background: rgba(249,115,22,0.14) !important; color: var(--sidebar-text) !important; }
      html.db-langues .sidebar .material-icons { color: var(--sidebar-text) !important; }
      /* make the nav-separator slightly warmer to blend with the sidebar */
      html.db-langues .nav-separator { background: transparent !important; }
      /* Stronger force: ensure the entire sidebar background becomes a solid gray and
         neutralize any inner white cards that could show through (use specific selectors
         and !important to beat utility classes like Tailwind's bg-white). */
      html.db-langues aside#sidebar, html.db-langues #sidebar, html.db-langues .sidebar {
        background-color: #4b5563 !important; /* much darker gray (Tailwind gray-600) */
        background-image: none !important;
        color: var(--sidebar-text) !important;
      }
      html.db-langues .sidebar .bg-white, html.db-langues .sidebar .card, html.db-langues .sidebar [class*="bg-white"] {
        background: transparent !important;
        box-shadow: none !important;
        border: none !important;
      }
      /* If sidebar items use inline utility classes (eg. rounded bg-white on links), make links transparent too */
      html.db-langues .sidebar a, html.db-langues .sidebar .group-header, html.db-langues .sidebar .logo-text {
        background: transparent !important;
      }
      /* Navbar / topbar color adjustments for langues DB: prefer a modern light-gray instead of pure white */
      html.db-langues header,
      html.db-langues .topbar,
      html.db-langues .page-header,
      html.db-langues .navbar,
      html.db-langues .main-header,
      html.db-langues .card.bg-white,
      html.db-langues .bg-white {
        background-color: #f3f4f6 !important; /* Tailwind gray-100 */
        color: var(--text-primary) !important;
        border-bottom: 1px solid rgba(2,6,23,0.04) !important;
      }
      /* Dashboard-specific header decoration: make the top title area stand out with a subtle gray panel */
      html.db-langues main header { background: linear-gradient(90deg,#f8fafc,#f3f4f6) !important; padding: 12px 18px !important; border-radius: 10px; border: 1px solid rgba(2,6,23,0.04) !important; }
      html.db-langues .header-text { color: #92400e !important; /* keep readable against the gray and match langues branding */ }
      /* Ensure header stats contrast nicely */
      html.db-langues .header-stats .header-stat { background: transparent !important; }
      /* Preserve the small banner shown for the langues DB */
      #dbLangBannerLarge { position: fixed; top: 72px; left: 50%; transform: translateX(-50%); z-index: 120; background: linear-gradient(90deg,#fff7ed,#fff3e0); padding: 10px 18px; border-radius: 10px; border: 2px solid #f97316; box-shadow: 0 10px 30px rgba(249,115,22,0.12); margin: 6px; }
    </style>
</body>
</html>
